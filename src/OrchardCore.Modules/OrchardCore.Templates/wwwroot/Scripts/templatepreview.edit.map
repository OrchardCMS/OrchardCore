{"version":3,"sources":["<anon>"],"sourcesContent":["var editor;\nfunction initializeTemplatePreview(nameElement, editorElement) {\n    var antiforgerytoken = $(\"[name='__RequestVerificationToken']\").val();\n    sendFormData = function (nameElement) {\n        var formData = {\n            'Name': nameElement.value,\n            'Content': editor.getValue(),\n            '__RequestVerificationToken': antiforgerytoken\n        };\n        // store the form data to pass it in the event handler\n        localStorage.setItem('OrchardCore.templates', JSON.stringify($.param(formData)));\n    }\n    editor = CodeMirror.fromTextArea(editorElement, {\n        autoRefresh: true,\n        lineNumbers: true,\n        lineWrapping: true,\n        matchBrackets: true,\n        styleActiveLine: true,\n        mode: { name: \"liquid\" },\n        extraKeys: {\n            \"F11\": function (cm) {\n                cm.setOption(\"fullScreen\", !cm.getOption(\"fullScreen\"));\n            },\n            \"Esc\": function (cm) {\n                if (cm.getOption(\"fullScreen\")) cm.setOption(\"fullScreen\", false);\n            }\n        }\n    });\n    editor.on('change', function (cm) {\n        sendFormData(nameElement);\n    });\n    window.addEventListener('storage', function (ev) {\n        if (ev.key != 'OrchardCore.templates:ready') return; // ignore other keys\n        // triggered by the preview window the first time it is loaded in order\n        // to pre-render the view even if no contentpreview:render is already sent\n        sendFormData(nameElement);\n    }, false);\n    $(nameElement)\n        .on('input', function () { sendFormData(nameElement); })\n        .on('propertychange', function () { sendFormData(nameElement); })\n        .on('change', function () { sendFormData(nameElement); })\n        .on('keyup', function (event) {\n            // handle backspace\n            if (event.keyCode == 46 || event.ctrlKey) {\n                sendFormData(nameElement);\n            }\n        });\n    $(window).on('unload', function () {\n        localStorage.removeItem('OrchardCore.templates');\n        // this will raise an event in the preview window to notify that the live preview is no longer active.\n        localStorage.setItem('OrchardCore.templates:not-connected', '');\n        localStorage.removeItem('OrchardCore.templates:not-connected');\n   });\n}\n"],"names":["editor","initializeTemplatePreview","nameElement","editorElement","antiforgerytoken","$","val","sendFormData","formData","value","getValue","localStorage","setItem","JSON","stringify","param","CodeMirror","fromTextArea","autoRefresh","lineNumbers","lineWrapping","matchBrackets","styleActiveLine","mode","name","extraKeys","cm","setOption","getOption","on","window","addEventListener","ev","key","event","keyCode","ctrlKey","removeItem"],"mappings":"AAAA,IAAIA,OAEJ,SAASC,0BAA0BC,CAAW,CAAEC,CAAa,EAEzD,IAAIC,EAAmBC,EAAE,uCAAuCC,GAAG,GAEnEC,aAAe,SAAUL,CAAW,EAEhC,IAAIM,EAAW,CACX,KAAQN,EAAYO,KAAK,CACzB,QAAWT,OAAOU,QAAQ,GAC1B,2BAA8BN,CAClC,EAGAO,aAAaC,OAAO,CAAC,wBAAyBC,KAAKC,SAAS,CAACT,EAAEU,KAAK,CAACP,IACzE,EAmBAR,AAjBAA,CAAAA,OAASgB,WAAWC,YAAY,CAACd,EAAe,CAC5Ce,YAAa,CAAA,EACbC,YAAa,CAAA,EACbC,aAAc,CAAA,EACdC,cAAe,CAAA,EACfC,gBAAiB,CAAA,EACjBC,KAAM,CAAEC,KAAM,QAAS,EACvBC,UAAW,CACP,IAAO,SAAUC,CAAE,EACfA,EAAGC,SAAS,CAAC,aAAc,CAACD,EAAGE,SAAS,CAAC,cAC7C,EACA,IAAO,SAAUF,CAAE,EACXA,EAAGE,SAAS,CAAC,eAAeF,EAAGC,SAAS,CAAC,aAAc,CAAA,EAC/D,CACJ,CACJ,EAAC,EAEME,EAAE,CAAC,SAAU,SAAUH,CAAE,EAC5BnB,aAAaL,EACjB,GAEA4B,OAAOC,gBAAgB,CAAC,UAAW,SAAUC,CAAE,EAC7B,+BAAVA,EAAGC,GAAG,EAIV1B,aAAaL,EACjB,EAAG,CAAA,GAEHG,EAAEH,GACG2B,EAAE,CAAC,QAAS,WAActB,aAAaL,EAAc,GACrD2B,EAAE,CAAC,iBAAkB,WAActB,aAAaL,EAAc,GAC9D2B,EAAE,CAAC,SAAU,WAActB,aAAaL,EAAc,GACtD2B,EAAE,CAAC,QAAS,SAAUK,CAAK,EAEpBA,CAAAA,AAAiB,IAAjBA,EAAMC,OAAO,EAAUD,EAAME,OAAO,AAAD,GACnC7B,aAAaL,EAErB,GAEJG,EAAEyB,QAAQD,EAAE,CAAC,SAAU,WACnBlB,aAAa0B,UAAU,CAAC,yBAExB1B,aAAaC,OAAO,CAAC,sCAAuC,IAC5DD,aAAa0B,UAAU,CAAC,sCAC7B,EACH"}
