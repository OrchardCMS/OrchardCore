@using OrchardCore.Sms.Services
@using OrchardCore.Sms.ViewModels
@using OrchardCore.Sms

@model TwilioSettingsViewModel

<div class="mb-3">
    <div class="form-check">
        <input type="checkbox" class="form-check-input" asp-for="IsEnabled" checked="@Model.IsEnabled" role="button" data-bs-toggle="collapse" data-bs-target="#Twilio_Provider_Settings" aria-expanded="@Model.IsEnabled.ToString().ToLowerInvariant()" aria-controls="Twilio_Provider_Settings" />
        <label class="form-check-label" asp-for="IsEnabled">@T["Enable Twilio Provider"]</label>
    </div>
</div>

<div id="Twilio_Provider_Settings" class="collapse @(Model.IsEnabled ? " show" : string.Empty)">

    <h4>@T["Twilio Account Info"]</h4>
    <div class="mb-3" asp-validation-class-for="PhoneNumber">
        <label asp-for="PhoneNumber" class="form-label">@T["Phone Number"]</label>
        <input asp-for="PhoneNumber" class="form-control" />
        <span asp-validation-for="PhoneNumber"></span>
        <span class="hint">@T["Phone number must include a country code. For example, +1 for United States."]</span>
    </div>

    <div class="mb-3" asp-validation-class-for="AccountSID">
        <label asp-for="AccountSID" class="form-label">@T["Account SID"]</label>
        <input asp-for="AccountSID" class="form-control" />
        <span asp-validation-for="AccountSID"></span>
    </div>

    <div class="mb-3" asp-validation-class-for="AuthTokenSecretName">
        <label asp-for="AuthTokenSecretName" class="form-label">@T["Auth Token Secret"]</label>
        @await Component.InvokeAsync("SelectSecret", new
        {
            secretTypes = new[] { "TextSecret" },
            selectedSecret = Model.AuthTokenSecretName,
            htmlId = "AuthTokenSecretName",
            htmlName = Html.NameFor(m => m.AuthTokenSecretName).ToString(),
            required = false
        })
        <span asp-validation-for="AuthTokenSecretName"></span>
        <span class="hint">@T["Select a secret containing the Twilio Auth Token."]</span>
        @if (Model.HasAuthToken && string.IsNullOrWhiteSpace(Model.AuthTokenSecretName))
        {
            <div class="alert alert-warning mt-2">
                <i class="fa-solid fa-exclamation-triangle"></i>
                @T["A legacy auth token is configured. Please migrate to using a secret for improved security."]
            </div>
        }
    </div>
</div>
