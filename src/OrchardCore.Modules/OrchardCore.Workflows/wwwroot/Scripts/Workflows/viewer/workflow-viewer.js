!function(t,e,o,n){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r="function"==typeof i[n]&&i[n],s=r.cache||{},a="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function l(e,o){if(!s[e]){if(!t[e]){var c="function"==typeof i[n]&&i[n];if(!o&&c)return c(e,!0);if(r)return r(e,!0);if(a&&"string"==typeof e)return a(e);var u=new Error("Cannot find module '"+e+"'");throw u.code="MODULE_NOT_FOUND",u}f.resolve=function(o){var n=t[e][1][o];return null!=n?n:o},f.cache={};var d=s[e]=new l.Module(e);t[e][0].call(d.exports,f,d,d.exports,i)}return s[e].exports;function f(t){var e=f.resolve(t);return!1===e?{}:l(e)}}l.isParcelRequire=!0,l.Module=function(t){this.id=t,this.bundle=l,this.exports={}},l.modules=t,l.cache=s,l.parent=r,l.register=function(e,o){t[e]=[function(t,e){e.exports=o},{}]},Object.defineProperty(l,"root",{get:function(){return i[n]}}),i[n]=l;for(var c=0;c<e.length;c++)l(e[c]);if(o){var u=l(o);"object"==typeof exports&&"undefined"!=typeof module?module.exports=u:"function"==typeof define&&define.amd&&define(function(){return u})}}({"2Pu8x":[function(t,e,o,n){var i=t("@parcel/transformer-js/src/esmodule-helpers.js"),r=(t("./workflow-models"),t("./workflow-canvas")),s=i.interopDefault(r);class a extends s.default{constructor(t,e){super(t,e),this.container=t,this.workflowType=e,this.getEndpointColor=t=>t.isBlocking?"#7ab02c":t.isEvent?"#3a8acd":"#7ab02c";jsPlumb.ready(()=>{jsPlumb.importDefaults(this.getDefaults());const t=this.createJsPlumbInstance();t.bind("connection",function(t,e){const o=t.connection,n=o.getParameters().outcome;o.getOverlay("label").setLabel(n.displayName);const i=t.sourceEndpoint;i&&i.hideOverlay&&i.hideOverlay("outcome-label")});let e=this.getActivityElements();t.batch(()=>{this.workflowType.id;e.each((e,o)=>{const n=$(o).data("activity-id"),i=this.getActivity(n);t.makeTarget(o,{dropOptions:{hoverClass:"hover"},anchor:"Continuous",endpoint:["Blank",{radius:8}]});for(let e of i.outcomes){const n=this.getSourceEndpointOptions(i,e),r=t.addEndpoint(o,{connectorOverlays:[["Label",{label:e.displayName,cssClass:"connection-label"}]]},n);this.endpointMap.push({endpoint:r,activityElement:o})}}),this.updateConnections(t),e=this.getActivityElements(),e.show(),this.updateCanvasHeight()}),this.orientOutcomeLabels(),this.jsPlumbInstance=t})}}$.fn.workflowViewer=function(){return this.each((t,e)=>{var o=$(e),n=o.data("workflow-type");o.data("workflowViewer",new a(e,n))}),this},$(document).ready(function(){$(".workflow-canvas").workflowViewer().data("workflowViewer")})},{"./workflow-models":"aM2tG","./workflow-canvas":"cHBDw","@parcel/transformer-js/src/esmodule-helpers.js":"dGByK"}],aM2tG:[function(t,e,o,n){},{}],cHBDw:[function(t,e,o,n){t("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(o);t("./workflow-models");o.default=class{constructor(t,e){this.container=t,this.workflowType=e,this.minCanvasHeight=400,this.endpointMap=[],this.getActivityElements=()=>$(this.container).find(".activity"),this.getDefaults=()=>({Anchor:"Continuous",DragOptions:{cursor:"pointer",zIndex:2e3},EndpointStyles:[{fillStyle:"#225588"}],Endpoints:[["Dot",{radius:7}],["Blank"]],ConnectionOverlays:[["Arrow",{width:12,length:12,location:-5}]],ConnectorZIndex:5}),this.createJsPlumbInstance=()=>jsPlumb.getInstance({DragOptions:{cursor:"pointer",zIndex:2e3},ConnectionOverlays:[["Arrow",{location:1,visible:!0,width:11,length:11}],["Label",{location:.5,id:"label",cssClass:"connection-label"}]],Container:this.container}),this.getEndpointColor=t=>t.isBlocking||t.isStart?"#7ab02c":t.isEvent?"#3a8acd":"#7ab02c",this.getSourceEndpointOptions=(t,e)=>{const o=this.getEndpointColor(t);return{endpoint:"Dot",anchor:"Continuous",paintStyle:{stroke:o,fill:o,radius:7,strokeWidth:1},isSource:!0,connector:["Flowchart",{stub:[40,60],gap:0,cornerRadius:5,alwaysRespectStubs:!0}],connectorStyle:{strokeWidth:2,stroke:"#999999",joinstyle:"round",outlineStroke:"white",outlineWidth:2},hoverPaintStyle:{fill:"#216477",stroke:"#216477"},connectorHoverStyle:{strokeWidth:3,stroke:"#216477",outlineWidth:5,outlineStroke:"white"},connectorOverlays:[["Label",{location:[3,-1.5],cssClass:"endpointSourceLabel"}]],overlays:[["Label",{label:e.displayName,cssClass:"outcome-label",id:"outcome-label",location:[0,0]}]],dragOptions:{},uuid:`${t.id}-${e.name}`,parameters:{outcome:e}}},this.getActivity=function(t,e=null){return e||(e=this.workflowType.activities),$.grep(e,e=>e.id===t)[0]},this.updateConnections=t=>{var e=this.workflowType.id;for(let o of this.workflowType.transitions){const n=`${o.sourceActivityId}-${o.sourceOutcomeName}`,i=t.getEndpoint(n),r=`activity-${e}-${o.destinationActivityId}`;t.connect({source:i,target:r})}},this.updateCanvasHeight=function(){const t=$(this.container),e=t.find(".activity");let o=0,n=0;for(let t of e.toArray()){const e=$(t),i=e.position().top;i>o&&(o=i,n=e.height())}let i=o+n;i-(o+n)<=100&&(i+=100),t.height(Math.max(this.minCanvasHeight,i))},this.orientOutcomeLabels=()=>{for(const{endpoint:t,activityElement:e}of this.endpointMap){const o=t.getOverlay?t.getOverlay("outcome-label"):null;if(!o)continue;const n=o.getElement?o.getElement():o.canvas;if(!n)continue;const i=t.canvas;if(!i)continue;const r=e.getBoundingClientRect(),s=i.getBoundingClientRect(),a=r.left+r.width/2,l=r.top+r.height/2,c=s.left+s.width/2-a,u=s.top+s.height/2-l;let d;d=(r.width>0?Math.abs(c)/(r.width/2):0)>(r.height>0?Math.abs(u)/(r.height/2):0)?c>0?"right":"left":u>0?"bottom":"top";const f=$(n);let h=f.outerWidth()/2;if(0===h){const t=n.style.display;n.style.display="block",h=f.outerWidth()/2,n.style.display=t}const p=n.style.transform||"",y=p&&"none"!==p?p+" ":"";switch(d){case"bottom":f.css({transform:y+`translateY(${h}px) rotate(90deg)`,"transform-origin":"center center"});break;case"top":f.css({transform:y+`translateY(-${h}px) rotate(-90deg)`,"transform-origin":"center center"});break;case"left":f.css({transform:y+`translateX(-${h}px)`});break;case"right":f.css({transform:y+`translateX(${h}px)`})}}}}}},{"./workflow-models":"aM2tG","@parcel/transformer-js/src/esmodule-helpers.js":"dGByK"}],dGByK:[function(t,e,o,n){o.interopDefault=function(t){return t&&t.__esModule?t:{default:t}},o.defineInteropFlag=function(t){Object.defineProperty(t,"__esModule",{value:!0})},o.exportAll=function(t,e){return Object.keys(t).forEach(function(o){"default"===o||"__esModule"===o||Object.prototype.hasOwnProperty.call(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[o]}})}),e},o.export=function(t,e,o){Object.defineProperty(t,e,{enumerable:!0,get:o})}},{}]},["2Pu8x"],"2Pu8x","parcelRequire94c2");
//# sourceMappingURL=workflow-viewer.js.map
