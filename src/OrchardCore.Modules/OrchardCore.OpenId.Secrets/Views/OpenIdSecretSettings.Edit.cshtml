@model OrchardCore.OpenId.Secrets.ViewModels.OpenIdSecretSettingsViewModel

<div class="card mb-3">
    <div class="card-header">
        <h5 class="mb-0">@T["RSA Keys from Secrets"]</h5>
    </div>
    <div class="card-body">
        <p class="text-muted">@T["Use RSA keys stored in Secrets instead of managed certificates. When set, these take precedence over the certificate store options."]</p>

        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label asp-for="SigningKeySecretName" class="form-label">@T["Signing Key Secret"]</label>
                    <select asp-for="SigningKeySecretName" class="form-select">
                        <option value="">@T["(Use managed certificates)"]</option>
                        @foreach (var secret in Model.AvailableRsaSecrets)
                        {
                            <option value="@secret" selected="@(secret == Model.SigningKeySecretName)">@secret</option>
                        }
                    </select>
                    <span class="hint">@T["Select an RSA key secret to use for signing JWT tokens."]</span>
                </div>
            </div>

            <div class="col-md-6">
                <div class="mb-3">
                    <label asp-for="EncryptionKeySecretName" class="form-label">@T["Encryption Key Secret"]</label>
                    <select asp-for="EncryptionKeySecretName" class="form-select">
                        <option value="">@T["(Use managed certificates)"]</option>
                        @foreach (var secret in Model.AvailableRsaSecrets)
                        {
                            <option value="@secret" selected="@(secret == Model.EncryptionKeySecretName)">@secret</option>
                        }
                    </select>
                    <span class="hint">@T["Select an RSA key secret to use for encrypting access tokens."]</span>
                </div>
            </div>
        </div>

        @if (!Model.AvailableRsaSecrets.Any())
        {
            <div class="alert alert-info">
                <i class="fa-solid fa-info-circle"></i>
                @T["No RSA key secrets found. Create an RSA key secret in Settings → Security → Secrets first."]
            </div>
        }
    </div>
</div>
