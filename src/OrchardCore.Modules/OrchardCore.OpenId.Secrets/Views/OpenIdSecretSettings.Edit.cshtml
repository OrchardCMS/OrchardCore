@model OrchardCore.OpenId.Secrets.ViewModels.OpenIdSecretSettingsViewModel

<div class="card mb-3">
    <div class="card-header">
        <h5 class="mb-0">@T["RSA Keys from Secrets"]</h5>
    </div>
    <div class="card-body">
        <p class="text-muted">@T["Use RSA keys stored in Secrets instead of managed certificates. When set, these take precedence over the certificate store options."]</p>

        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label asp-for="SigningKeySecretName" class="form-label">@T["Signing Key Secret"]</label>
                    @await Component.InvokeAsync("SelectSecret", new { 
                        secretTypes = new[] { "RsaKeySecret", "X509Secret" },
                        selectedSecret = Model.SigningKeySecretName,
                        htmlId = "SigningKeySecretName",
                        htmlName = "OpenIdSecretSettings.SigningKeySecretName",
                        required = false
                    })
                    <span class="hint">@T["Select an RSA key or X.509 certificate secret to use for signing JWT tokens."]</span>
                </div>
            </div>

            <div class="col-md-6">
                <div class="mb-3">
                    <label asp-for="EncryptionKeySecretName" class="form-label">@T["Encryption Key Secret"]</label>
                    @await Component.InvokeAsync("SelectSecret", new { 
                        secretTypes = new[] { "RsaKeySecret", "X509Secret" },
                        selectedSecret = Model.EncryptionKeySecretName,
                        htmlId = "EncryptionKeySecretName",
                        htmlName = "OpenIdSecretSettings.EncryptionKeySecretName",
                        required = false
                    })
                    <span class="hint">@T["Select an RSA key or X.509 certificate secret to use for encrypting access tokens."]</span>
                </div>
            </div>
        </div>
    </div>
</div>
