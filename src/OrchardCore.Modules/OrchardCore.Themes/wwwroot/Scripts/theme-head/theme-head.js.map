{"mappings":"osCAAA,IAAAA,EAAAC,EAAA,eAIA,MAAMC,EAAgB,IAAIC,kBAAiB,SAAUC,GAEjD,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAUE,OAAQD,IAClC,IAAK,IAAIE,EAAI,EAAGA,EAAIH,EAAUC,GAAGG,WAAWF,OAAQC,IAAK,CAG3B,SADRH,EAAUC,GAAGG,WAAWD,GAC5BE,WACV,EAAAT,EAAAU,WAAS,EAAAV,EAAAW,sBAGTT,EAAcU,aAEtB,CAER,IAEAV,EAAcW,QAAQC,SAASC,gBAAiB,CAC5CC,WAAW,EACXC,SAAS,G,uICuBbC,EAAAC,OAAAC,EAAA,qBACIC,IADJH,EAAAC,OAAAC,EAAA,sBAEIE,IAFJJ,EAAAC,OAAAC,EAAA,2BAGIG,IAHJL,EAAAC,OAAAC,EAAA,yBAIII,IAJJN,EAAAC,OAAAC,EAAA,mBAKIK,IALJP,EAAAC,OAAAC,EAAA,sBAMIM,IANJR,EAAAC,OAAAC,EAAA,sBAOIO,IAPJT,EAAAC,OAAAC,EAAA,mBAQIQ,IARJV,EAAAC,OAAAC,EAAA,yBASIT,IATJO,EAAAC,OAAAC,EAAA,gBAUIV,IAvDJ,IAAAmB,EAAA5B,EAAA,sCAEA,MAAMoB,EAAgB,OAChBC,EAAiB,QACjBC,EAAsB,QAEtBC,EAAoB,IAAMD,GAAuB,QAEjDE,EAAc,IAAM,IAAG,EAAAI,EAAAC,oBAAmBN,MAE1CE,EAAiB,IAAMK,aAAaC,QAAQP,KAE5CE,EAAkBM,IAChBA,GACAF,aAAaG,QAAQT,IAAeQ,EAAA,EAItCL,EAAc,IAChBO,OAAOC,WAAW,gCAAgCC,QAEhD1B,EAAoB,KACtB,MAAM2B,EAAcZ,IACpB,OAAIY,IAIGV,IAAgBP,EAAgBC,EAAA,EAGrCZ,EAAYuB,IACTA,IAIS,SAAVA,EACAnB,SAASC,gBAAgBwB,aACrB,gBACAX,IAAgBP,EAAgBC,GAGpCR,SAASC,gBAAgBwB,aAAa,gBAAiBN,GAAS,K,qNCvCxEf,EAAAC,OAAAC,EAAA,qBAASU,IAFT,MAAMA,EAAgB,IAAMhB,SAASC,gBAAgByB,aAAa,gBAAkB,S,uFCApFpB,EAAQqB,eAAiB,SAAUC,GACjC,OAAOA,GAAKA,EAAEC,WAAaD,EAAI,CAACE,QAASF,EAC3C,EAEAtB,EAAQyB,kBAAoB,SAAUH,GACpCI,OAAOC,eAAeL,EAAG,aAAc,CAACM,OAAO,GACjD,EAEA5B,EAAQ6B,UAAY,SAAUC,EAAQC,GAkBpC,OAjBAL,OAAOM,KAAKF,GAAQG,SAAQ,SAAUC,GAE1B,YAARA,GACQ,eAARA,GACAR,OAAOS,UAAUC,eAAeC,KAAKN,EAAMG,IAK7CR,OAAOC,eAAeI,EAAMG,EAAK,CAC/BI,YAAY,EACZC,IAAK,WACH,OAAOT,EAAOI,EAChB,GAEJ,IAEOH,CACT,EAEA/B,EAAQD,OAAS,SAAUgC,EAAMS,EAAUD,GACzCb,OAAOC,eAAeI,EAAMS,EAAU,CACpCF,YAAY,EACZC,IAAKA,GAET,C","sources":["src/OrchardCore.Modules/OrchardCore.Themes/Assets/ts/theme-head.ts","src/OrchardCore.Modules/OrchardCore.Themes/Assets/ts/constants.ts",".scripts/bloom/helpers/globals.ts","node_modules/@parcel/transformer-js/src/esmodule-helpers.js"],"sourcesContent":["import { getPreferredTheme, setTheme } from \"./constants\";\r\n\r\n// We need to apply the classes BEFORE the page is rendered. \r\n// That is why we use a MutationObserver instead of document.Ready().\r\nconst themeObserver = new MutationObserver(function (mutations) {\r\n\r\n    for (let i = 0; i < mutations.length; i++) {\r\n        for (let j = 0; j < mutations[i].addedNodes.length; j++) {\r\n\r\n            const addedNode = mutations[i].addedNodes[j] as HTMLElement;\r\n            if (addedNode.tagName === 'BODY') {\r\n                setTheme(getPreferredTheme());\r\n\r\n                // we're done: \r\n                themeObserver.disconnect();\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\nthemeObserver.observe(document.documentElement, {\r\n    childList: true,\r\n    subtree: true\r\n});\r\n","import { getTenantName } from \"@orchardcore/bloom/helpers/globals\";\r\n\r\nconst darkThemeName = \"dark\";\r\nconst lightThemeName = \"light\";\r\nconst themeStoreKeySuffix = \"theme\";\r\n\r\nconst getStoreKeySuffix = () => themeStoreKeySuffix || \"theme\";\r\n\r\nconst getStoreKey = () => `${getTenantName()}-${getStoreKeySuffix()}`;\r\n\r\nconst getStoredTheme = () => localStorage.getItem(getStoreKey());\r\n\r\nconst setStoredTheme = (theme: string | null) => {\r\n    if (theme) {\r\n        localStorage.setItem(getStoreKey(), theme);\r\n    }\r\n};\r\n\r\nconst isDarkMedia = () =>\r\n    window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\n\r\nconst getPreferredTheme = () => {\r\n    const storedTheme = getStoredTheme();\r\n    if (storedTheme) {\r\n        return storedTheme;\r\n    }\r\n\r\n    return isDarkMedia() ? darkThemeName : lightThemeName;\r\n};\r\n\r\nconst setTheme = (theme: string | null) => {\r\n    if (!theme) {\r\n        return;\r\n    }\r\n\r\n    if (theme === \"auto\") {\r\n        document.documentElement.setAttribute(\r\n            \"data-bs-theme\",\r\n            isDarkMedia() ? darkThemeName : lightThemeName\r\n        );\r\n    } else {\r\n        document.documentElement.setAttribute(\"data-bs-theme\", theme ?? \"\");\r\n    }\r\n};\r\n\r\nexport {\r\n    darkThemeName,\r\n    lightThemeName,\r\n    themeStoreKeySuffix,\r\n    getStoreKeySuffix,\r\n    getStoreKey,\r\n    getStoredTheme,\r\n    setStoredTheme,\r\n    isDarkMedia,\r\n    getPreferredTheme,\r\n    setTheme,\r\n};\r\n","const getTenantName = () => document.documentElement.getAttribute(\"data-tenant\") || \"default\";\r\n\r\nexport { getTenantName };\r\n","exports.interopDefault = function (a) {\n  return a && a.__esModule ? a : {default: a};\n};\n\nexports.defineInteropFlag = function (a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n};\n\nexports.exportAll = function (source, dest) {\n  Object.keys(source).forEach(function (key) {\n    if (\n      key === 'default' ||\n      key === '__esModule' ||\n      Object.prototype.hasOwnProperty.call(dest, key)\n    ) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function () {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n};\n\nexports.export = function (dest, destName, get) {\n  Object.defineProperty(dest, destName, {\n    enumerable: true,\n    get: get,\n  });\n};\n"],"names":["_constants","require","themeObserver","MutationObserver","mutations","i","length","j","addedNodes","tagName","setTheme","getPreferredTheme","disconnect","observe","document","documentElement","childList","subtree","parcelHelpers","export","exports","darkThemeName","lightThemeName","themeStoreKeySuffix","getStoreKeySuffix","getStoreKey","getStoredTheme","setStoredTheme","isDarkMedia","_globals","getTenantName","localStorage","getItem","theme","setItem","window","matchMedia","matches","storedTheme","setAttribute","getAttribute","interopDefault","a","__esModule","default","defineInteropFlag","Object","defineProperty","value","exportAll","source","dest","keys","forEach","key","prototype","hasOwnProperty","call","enumerable","get","destName"],"version":3,"file":"theme-head.js.map"}