{"version":3,"sources":["<anon>"],"sourcesContent":["const insertAtCaret = (element, myValue) => {\n    if (document.selection) {\n        //For browsers like Internet Explorer\n        element.focus();\n        const sel = document.selection.createRange();\n        sel.text = myValue;\n        element.focus();\n    } else if (element.selectionStart || element.selectionStart === \"0\") {\n        //For browsers like Firefox and Webkit based\n        const startPos = element.selectionStart;\n        const endPos = element.selectionEnd;\n        const scrollTop = element.scrollTop;\n        element.value = element.value.substring(0, startPos) + myValue + element.value.substring(endPos, element.value.length);\n        element.focus();\n        element.selectionStart = startPos + myValue.length;\n        element.selectionEnd = startPos + myValue.length;\n        element.scrollTop = scrollTop;\n    } else {\n        element.value += myValue;\n        element.focus();\n    }\n};\n\nconst shortcodeBtnTemplate = `\n<button type=\"button\" class=\"shortcode-modal-btn btn btn-sm\">\n    <span class=\"icon-shortcode\"></span>\n</button>\n`;\n\n// Wraps each .shortcode-modal-input class with a wrapper, and attaches detaches the shortcode app as required.\ndocument.addEventListener('DOMContentLoaded', () => {\n    const inputs = document.querySelectorAll('.shortcode-modal-input');\n    inputs.forEach(input => {\n        const wrapper = document.createElement('div');\n        wrapper.classList.add('shortcode-modal-wrapper');\n        input.parentElement.insertBefore(wrapper, input);\n        wrapper.appendChild(input);\n\n        input.parentElement.insertAdjacentHTML('beforeend', shortcodeBtnTemplate);        \n    });\n\n    const buttons = document.querySelectorAll('.shortcode-modal-btn');\n    buttons.forEach(button => {\n        button.addEventListener('click', event => {\n            const input = event.target.closest('.shortcode-modal-wrapper').querySelector('.shortcode-modal-input');\n\n            shortcodesApp.init(defaultValue => {\n                insertAtCaret(input, defaultValue);\n            });\n        });\n    });\n})\n\nvar shortcodesApp;\n\nfunction initializeShortcodesApp(element) {\n    if (element && !shortcodesApp) {\n        var elementId = element.id;\n\n        shortcodesApp = new Vue({\n            el: '#' + elementId,\n            data : function () {\n                \n                var shortcodes = JSON.parse(element.dataset.shortcodes || \"[]\");\n                var categories = JSON.parse(element.dataset.categories || \"[]\");\n\n                return {\n                    filter: '',\n                    allShortcodes: shortcodes,\n                    filteredShortcodes: shortcodes,\n                    categories: categories,\n                    defaultValue: '',\n                    modal: null\n                }\n            },\n            watch:\n            {\n                filter(filter) {\n                    if (filter) {\n                        var lower = filter.toLowerCase();\n                        this.filteredShortcodes = this.allShortcodes\n                            .filter(s => s.name.startsWith(lower));\n                    } else {\n                        this.filteredShortcodes = this.allShortcodes;\n                    }\n                }\n            },            \n            methods: {\n                init(onClose)\n                {\n                    if (onClose) {\n                        this.onClose = onClose;\n                    }\n                    this.selectedValue = '';\n                    this.modal = new bootstrap.Modal(this.$el);\n                    this.modal.show();\n                    var self = this;\n                    this.$el.addEventListener('shown.bs.modal', function (e) {\n                        self.$refs.filter.focus();\n                    });\n                },\n                onClose(defaultValue)\n                {\n                    return;\n                },\n                setCategory(category)\n                {\n                    if (category) {\n                        this.filteredShortcodes = this.allShortcodes\n                            .filter(s => s.categories.some(c => c.toLowerCase() === category.toLowerCase()));\n                    } else {\n                        this.filteredShortcodes = this.allShortcodes;\n                    }\n                    this.filter = '';\n                },            \n                isVisible(name) {\n                    return this.filteredShortcodes.some(s => s.name === name);\n                },\n                insertShortcode(event) {\n                    this.defaultValue =  event.target.dataset.defaultValue;\n                    this.modal.hide();\n                    this.onClose(this.defaultValue);\n                }\n            }\n        });\n\n        return shortcodesApp;\n    }\n}\n\n// initializes a code mirror editor with a shortcode modal.\nfunction initializeCodeMirrorShortcodeWrapper(editor) {\n    const codemirrorWrapper = editor.display.wrapper;\n\n    const wrapper = document.createElement('div');\n    wrapper.classList.add('shortcode-modal-wrapper');\n    codemirrorWrapper.parentElement.insertBefore(wrapper, codemirrorWrapper);\n    wrapper.appendChild(codemirrorWrapper);\n\n    codemirrorWrapper.parentElement.insertAdjacentHTML('beforeend', shortcodeBtnTemplate);\n    codemirrorWrapper.parentElement.querySelector('.shortcode-modal-btn').addEventListener('click', () => {\n        shortcodesApp.init(defaultValue => {\n            editor.replaceSelection(defaultValue);   \n        });   \n    });\n}\n"],"names":["shortcodesApp","insertAtCaret","element","myValue","document","selection","focus","sel","createRange","text","selectionStart","startPos","endPos","selectionEnd","scrollTop","value","substring","length","shortcodeBtnTemplate","initializeShortcodesApp","Vue","el","id","data","shortcodes","JSON","parse","dataset","filter","allShortcodes","filteredShortcodes","categories","defaultValue","modal","watch","lower","toLowerCase","s","name","startsWith","methods","init","onClose","selectedValue","bootstrap","Modal","$el","show","self","addEventListener","e","$refs","setCategory","category","some","c","isVisible","insertShortcode","event","target","hide","initializeCodeMirrorShortcodeWrapper","editor","codemirrorWrapper","display","wrapper","createElement","classList","add","parentElement","insertBefore","appendChild","insertAdjacentHTML","querySelector","replaceSelection","inputs","querySelectorAll","forEach","input","buttons","button","closest"],"mappings":"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"}
