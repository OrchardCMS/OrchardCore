var shortcodesApp;let insertAtCaret=(e,t)=>{if(document.selection)e.focus(),document.selection.createRange().text=t,e.focus();else if(e.selectionStart||"0"===e.selectionStart){let o=e.selectionStart,s=e.selectionEnd,r=e.scrollTop;e.value=e.value.substring(0,o)+t+e.value.substring(s,e.value.length),e.focus(),e.selectionStart=o+t.length,e.selectionEnd=o+t.length,e.scrollTop=r}else e.value+=t,e.focus()},shortcodeBtnTemplate=`
<button type="button" class="shortcode-modal-btn btn btn-sm">
    <span class="icon-shortcode"></span>
</button>
`;function initializeShortcodesApp(e){if(e&&!shortcodesApp)return shortcodesApp=new Vue({el:"#"+e.id,data:function(){var t=JSON.parse(e.dataset.shortcodes||"[]");return{filter:"",allShortcodes:t,filteredShortcodes:t,categories:JSON.parse(e.dataset.categories||"[]"),defaultValue:"",modal:null}},watch:{filter(e){if(e){var t=e.toLowerCase();this.filteredShortcodes=this.allShortcodes.filter(e=>e.name.startsWith(t))}else this.filteredShortcodes=this.allShortcodes}},methods:{init(e){e&&(this.onClose=e),this.selectedValue="",this.modal=new bootstrap.Modal(this.$el),this.modal.show();var t=this;this.$el.addEventListener("shown.bs.modal",function(e){t.$refs.filter.focus()})},onClose(e){},setCategory(e){e?this.filteredShortcodes=this.allShortcodes.filter(t=>t.categories.some(t=>t.toLowerCase()===e.toLowerCase())):this.filteredShortcodes=this.allShortcodes,this.filter=""},isVisible(e){return this.filteredShortcodes.some(t=>t.name===e)},insertShortcode(e){this.defaultValue=e.target.dataset.defaultValue,this.modal.hide(),this.onClose(this.defaultValue)}}})}function initializeCodeMirrorShortcodeWrapper(e){let t=e.display.wrapper,o=document.createElement("div");o.classList.add("shortcode-modal-wrapper"),t.parentElement.insertBefore(o,t),o.appendChild(t),t.parentElement.insertAdjacentHTML("beforeend",shortcodeBtnTemplate),t.parentElement.querySelector(".shortcode-modal-btn").addEventListener("click",()=>{shortcodesApp.init(t=>{e.replaceSelection(t)})})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".shortcode-modal-input").forEach(e=>{let t=document.createElement("div");t.classList.add("shortcode-modal-wrapper"),e.parentElement.insertBefore(t,e),t.appendChild(e),e.parentElement.insertAdjacentHTML("beforeend",shortcodeBtnTemplate)}),document.querySelectorAll(".shortcode-modal-btn").forEach(e=>{e.addEventListener("click",e=>{let t=e.target.closest(".shortcode-modal-wrapper").querySelector(".shortcode-modal-input");shortcodesApp.init(e=>{insertAtCaret(t,e)})})})});
