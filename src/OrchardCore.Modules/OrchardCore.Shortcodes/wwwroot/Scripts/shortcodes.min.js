var shortcodesApp;jQuery.fn.extend({insertAtCaret:function(t){return this.each(function(e){if(document.selection)this.focus(),(sel=document.selection.createRange()).text=t,this.focus();else if(this.selectionStart||"0"===this.selectionStart){var s=this.selectionStart,o=this.selectionEnd,i=this.scrollTop;this.value=this.value.substring(0,s)+t+this.value.substring(o,this.value.length),this.focus(),this.selectionStart=s+t.length,this.selectionEnd=s+t.length,this.scrollTop=i}else this.value+=t,this.focus()})}});let shortcodeWrapperTemplate=`
<div class="shortcode-modal-wrapper"></div>
`,shortcodeBtnTemplate=`
<button type="button" class="shortcode-modal-btn btn btn-sm">
    <span class="icon-shortcode"></span>
</button>
`;function initializeShortcodesApp(t){if(t&&!shortcodesApp)return shortcodesApp=new Vue({el:"#"+t.id,data:function(){var e=JSON.parse(t.dataset.shortcodes||"[]");return{filter:"",allShortcodes:e,filteredShortcodes:e,categories:JSON.parse(t.dataset.categories||"[]"),defaultValue:"",modal:null}},watch:{filter(t){if(t){var e=t.toLowerCase();this.filteredShortcodes=this.allShortcodes.filter(t=>t.name.startsWith(e))}else this.filteredShortcodes=this.allShortcodes}},methods:{init(t){t&&(this.onClose=t),this.selectedValue="",this.modal=new bootstrap.Modal(this.$el),this.modal.show();var e=this;$(this.$el).on("shown.bs.modal",function(t){e.$refs.filter.focus()})},onClose(t){},setCategory(t){t?this.filteredShortcodes=this.allShortcodes.filter(e=>e.categories.some(e=>e.toLowerCase()===t.toLowerCase())):this.filteredShortcodes=this.allShortcodes,this.filter=""},isVisible(t){return this.filteredShortcodes.some(e=>e.name===t)},insertShortcode(t){this.defaultValue=t.target.dataset.defaultValue,this.modal.hide(),this.onClose(this.defaultValue)}}})}function initializeCodeMirrorShortcodeWrapper(t){let e=t.display.wrapper;$(e).wrap(shortcodeWrapperTemplate),$(e).parent().append(shortcodeBtnTemplate),$(e).siblings(".shortcode-modal-btn").on("click",function(){shortcodesApp.init(function(e){t.replaceSelection(e)})})}$(function(){$(".shortcode-modal-input").each(function(){$(this).wrap(shortcodeWrapperTemplate),$(this).parent().append(shortcodeBtnTemplate)}),$(".shortcode-modal-btn").on("click",function(){var t=$(this).siblings(".shortcode-modal-input");shortcodesApp.init(function(e){t.insertAtCaret(e)})})});