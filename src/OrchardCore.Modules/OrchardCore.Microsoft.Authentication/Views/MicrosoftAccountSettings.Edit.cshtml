@using OrchardCore.Microsoft.Authentication.ViewModels
@model MicrosoftAccountSettingsViewModel

<p class="alert alert-warning" role="alert">
    @T["The website might be restarted upon saving the settings, potentially leading to temporary unresponsiveness during the process."]
    <a class="seedoc" href="@(OrchardCore.Admin.Constants.DocsUrl)reference/modules/Microsoft.Authentication/#microsoft-account" target="_blank">@T["See documentation"]</a>
</p>

@if (Model.HasAppSecret)
{
    <p class="alert alert-info">@T["A legacy app secret is configured. Please create a new secret using the Secrets module and select it below, then save to complete the migration."]</p>
}

<h3>@T["Microsoft Account Authentication Settings"]</h3>

<div class="mb-3" asp-validation-class-for="AppId">
    <label asp-for="AppId" class="form-label">@T["AppId"]</label>
    <input asp-for="AppId" class="form-control" />
    <span asp-validation-for="AppId"></span>
    <span class="hint">@T["The Application ID found on the Microsoft developer portal parameters."]</span>
</div>

<div class="mb-3">
    <label asp-for="AppSecretSecretName" class="form-label">@T["App Secret"]</label>
    @await Component.InvokeAsync("SelectSecret", new
    {
        secretTypes = new[] { "TextSecret" },
        selectedSecret = Model.AppSecretSecretName,
        htmlId = "AppSecretSecretName",
        htmlName = Html.NameFor(m => m.AppSecretSecretName).ToString(),
        required = false
    })
    <span class="hint">@T["Select a secret containing the Application secret key from the Microsoft developer portal."]</span>
</div>

<div class="mb-3" asp-validation-class-for="CallbackPath">
    <label asp-for="CallbackPath" class="form-label">@T["CallbackPath"]</label>
    <input asp-for="CallbackPath" class="form-control" placeholder="/signin-microsoft" />
    <span asp-validation-for="CallbackPath"></span>
    <span class="hint">@T["The request path within the application's base path where the user-agent will be returned. The middleware will process this request when it arrives."]</span>
</div>

<div class="mb-3" asp-validation-class-for="SaveTokens">
    <div class="form-check">
        <input type="checkbox" class="form-check-input" asp-for="SaveTokens">
        <label class="form-check-label" asp-for="SaveTokens">@T["Store tokens"]</label>
        <span class="hint dashed">@T["Store external authentication tokens for reuse"]</span>
    </div>
</div>
