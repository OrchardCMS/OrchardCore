function getPrefixIndex(t,e){return Math.max(...e.querySelectorAll(`input[name*='${t}-']`).values().map(t=>parseInt(t.value.substring(t.value.lastIndexOf("-")+1))||0))+1}!function(){document.addEventListener("click",function(event){if(event.target.classList.contains("add-list-widget")){var type=event.target.dataset.widgetType,targetId=event.target.dataset.targetId,htmlFieldPrefix=event.target.dataset.htmlFieldPrefix,createEditorUrl=document.getElementById(targetId).dataset.buildeditorurl,prefixesName=event.target.dataset.prefixesName,parentContentType=event.target.dataset.parentContentType,partName=event.target.dataset.partName,zonesName=event.target.dataset.zonesName,zone=event.target.dataset.zone,index=getPrefixIndex(htmlFieldPrefix,document.getElementById(targetId).closest("form")),prefix=htmlFieldPrefix+"-"+index.toString(),contentTypesName=event.target.dataset.contenttypesName,contentItemsName=event.target.dataset.contentitemsName;fetch(`${createEditorUrl}?id=${type}&prefix=${prefix}&prefixesName=${prefixesName}&contentTypesName=${contentTypesName}&contentItemsName=${contentItemsName}&zonesName=${zonesName}&zone=${zone}&targetId=${targetId}&parentContentType=${parentContentType}&partName=${partName}`).then(t=>t.json()).then(data=>{document.getElementById(targetId).insertAdjacentHTML("beforeend",data.Content);var dom=new DOMParser().parseFromString(data.Scripts,"text/html");Array.from(dom.querySelectorAll("script")).forEach(script=>{eval(script.textContent||script.innerHTML)})})}else if(event.target.classList.contains("insert-list-widget")){var type=event.target.dataset.widgetType,target=event.target.closest(".widget-template"),targetId=event.target.dataset.targetId,htmlFieldPrefix=event.target.dataset.htmlFieldPrefix,createEditorUrl=document.getElementById(targetId).dataset.buildeditorurl,prefixesName=event.target.dataset.prefixesName,parentContentType=event.target.dataset.parentContentType,partName=event.target.dataset.partName,zonesName=event.target.dataset.zonesName,zone=event.target.dataset.zone,index=getPrefixIndex(htmlFieldPrefix,document.getElementById(targetId).closest("form")),prefix=htmlFieldPrefix+"-"+index.toString(),contentTypesName=event.target.dataset.contenttypesName,contentItemsName=event.target.dataset.contentitemsName;fetch(`${createEditorUrl}?id=${type}&prefix=${prefix}&prefixesName=${prefixesName}&contentTypesName=${contentTypesName}&contentItemsName=${contentItemsName}&zonesName=${zonesName}&zone=${zone}&targetId=${targetId}&parentContentType=${parentContentType}&partName=${partName}`).then(t=>t.json()).then(data=>{target.insertAdjacentHTML("beforebegin",data.Content);var dom=new DOMParser().parseFromString(data.Scripts,"text/html");Array.from(dom.querySelectorAll("script")).forEach(script=>{eval(script.textContent||script.innerHTML)})})}}),document.addEventListener("click",function(t){if(t.target.classList.contains("widget-list-delete")){var e=t.target;confirmDialog(_objectSpread({},e.dataset,{callback:function(t){t&&(e.closest(".widget-template").remove(),document.dispatchEvent(new CustomEvent("contentpreview:render")))}}))}}),document.addEventListener("change",function(t){t.target.closest(".widget-editor-footer")&&document.dispatchEvent(new CustomEvent("contentpreview:render"))}),document.addEventListener("click",function(t){t.target.classList.contains("widget-list-editor-btn-toggle")&&t.target.closest(".widget-editor").classList.toggle("collapsed")})}();