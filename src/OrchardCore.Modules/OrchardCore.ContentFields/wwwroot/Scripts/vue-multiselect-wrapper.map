{"version":3,"sources":["<anon>"],"sourcesContent":["function debounce(func, wait, immediate) {\n    var timeout;\n    return function () {\n        var context = this, args = arguments;\n        var later = function () {\n            timeout = null;\n            if (!immediate) func.apply(context, args);\n        };\n        var callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) func.apply(context, args);\n    };\n};\nfunction initVueMultiselect(element) {\n    // only run script if element exists\n    if (element) {\n        var elementId = element.id;\n        var selectedItems = JSON.parse(element.dataset.selectedItems || \"[]\");\n        var editUrl = element.dataset.editUrl;\n        var viewUrl = element.dataset.viewUrl;\n        var searchUrl = element.dataset.searchUrl;\n        var multiple = JSON.parse(element.dataset.multiple);\n        var debouncedSearch = debounce(function (vm, query) {\n            vm.isLoading = true;\n            var searchFullUrl = searchUrl;\n            if (query) {\n                searchFullUrl += '&query=' + query;\n            }\n            fetch(searchFullUrl).then(function (res) {\n                res.json().then(function (json) {\n                    vm.options = json;\n                    vm.isLoading = false;\n                })\n            });\n        }, 250);\n        var vueMultiselect = Vue.component('vue-multiselect', window.VueMultiselect.default);\n        var vm = new Vue({\n            el: '#' + elementId,\n            components: { 'vue-multiselect': vueMultiselect },\n            data: {\n                value: null,\n                arrayOfItems: selectedItems,\n                options: [],\n            },\n            computed: {\n                selectedIds: function () {\n                    return this.arrayOfItems.map(function (x) { return x.id }).join(',');\n                },\n                isDisabled: function () {\n                    return this.arrayOfItems.length > 0 && !multiple;\n                }\n            },\n            watch: {\n                selectedIds: function () {\n                    // We add a delay to allow for the <input> to get the actual value\t\n                    // before the form is submitted\t\n                    setTimeout(function () { $(document).trigger('contentpreview:render') }, 100);\n                }\n            },\n            created: function () {\n                var self = this;\n                self.asyncFind();\n            },\n            mounted: function () {\n                // Store a reference to the div containing the search box used to select content\n                // items so we can hide/show it later (in onSelect and remove). We use the \"mounted\"\n                // lifecycle method rather than \"created\" so we know the component has been attached \n                // to the DOM and we can therefore travese the DOM to find the desired div.\n                this.searchBoxContainer = $(this.$el).children().last();\n                // If we're loading an existing content item, we may already have a content picker\n                // configured to only allow a single content item and that item has already been selected. \n                // In this case, we need to hide the search box now and not wait for onSelect or remove.\n                this.searchBoxContainer.css(\"display\", multiple || this.arrayOfItems.length === 0 ? \"block\" : \"none\");\n            },\n            methods: {\n                asyncFind: function (query) {\n                    var self = this;\n                    debouncedSearch(self, query);\n                },\n                onSelect: function (selectedOption, id) {\n                    var self = this;\n                    for (i = 0; i < self.arrayOfItems.length; i++) {\n                        if (self.arrayOfItems[i].id === selectedOption.id) {\n                            return;\n                        }\n                    }\n                    self.arrayOfItems.push(selectedOption);\n                    // We don't want to show the search box if we are only allowing a single content \n                    // item and a content item has already been selected. We don't need that search \n                    // box again unless and until we delete the currently selected content item. \n                    // So here we set the display mode accordingly. We always show the select list \n                    // if allowing multiple content items and do not show it if we're only allowing \n                    // a single content item and we've just selected that one item.\n                    this.searchBoxContainer.css(\"display\", multiple ? \"block\" : \"none\");\n                },\n                url: function(item) {\n                    var url = item.isEditable ? editUrl : viewUrl;\n                    return url.replace('contentItemId', item.id);\n                },\n                remove: function (item) {\n                    this.arrayOfItems.splice(this.arrayOfItems.indexOf(item), 1);\n                    // After removing a selected content item, we always want to show the search box \n                    // since (1) if we are allowing multiple content types to be selected, we always \n                    // want to show it, and (2) if we are only allowing a single content type to be \n                    // selected, and we've just removed that content type, we now need to show the \n                    // search box so we are able to add a new one.\n                    this.searchBoxContainer.css(\"display\", \"block\");\n                }\n            }\n        })\n        \n        /*Hook for other scripts that might want to have access to the view model*/\n        var event = new CustomEvent(\"vue-multiselect-created\", { detail: { vm: vm } });\n        document.querySelector(\"body\").dispatchEvent(event);\n    }\n}\n"],"names":["debounce","func","wait","immediate","timeout","context","args","arguments","callNow","clearTimeout","setTimeout","apply","initVueMultiselect","element","elementId","id","selectedItems","JSON","parse","dataset","editUrl","viewUrl","searchUrl","multiple","debouncedSearch","vm","query","isLoading","searchFullUrl","fetch","then","res","json","options","vueMultiselect","Vue","component","window","VueMultiselect","default","event","CustomEvent","detail","el","components","data","value","arrayOfItems","computed","selectedIds","map","x","join","isDisabled","length","watch","$","document","trigger","created","self","asyncFind","mounted","searchBoxContainer","$el","children","last","css","methods","onSelect","selectedOption","i","push","url","item","isEditable","replace","remove","splice","indexOf","querySelector","dispatchEvent"],"mappings":"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"}
