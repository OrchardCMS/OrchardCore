{"version":3,"sources":["<anon>"],"sourcesContent":["//variables used in FlowPart.Edit sortable\nvar widgetDragItem, lastContainer, widgetItemSourceId, widgetItemDestId;\n\n$(function () {\n    $(document).on('click', '.add-widget', function (event) {\n        var type = $(this).data(\"widget-type\");\n        var targetId = $(this).data(\"target-id\");\n        var htmlFieldPrefix = $(this).data(\"html-field-prefix\");\n        var createEditorUrl = $('#' + targetId).data(\"buildeditorurl\");\n        var prefixesName = $(this).data(\"prefixes-name\");\n        var flowmetadata = $(this).data(\"flowmetadata\");\n        var parentContentType = $(this).data(\"parent-content-type\");\n        var partName = $(this).data(\"part-name\");\n\n        // Retrieve all index values knowing that some elements may have been moved / removed.\n        var indexes = $('#' + targetId).closest(\"form\").find(\"input[name*='Prefixes']\")\n            .filter(function (i, e) {\n                return $(e).val().substring(0, $(e).val().lastIndexOf('-')) === htmlFieldPrefix;\n            })\n            .map(function (i, e) {\n                return parseInt($(e).val().substring($(e).val().lastIndexOf('-') + 1)) || 0;\n            });\n\n        // Use a prefix based on the items count (not a guid) so that the browser autofill still works.\n        var index = indexes.length ? Math.max(...indexes) + 1 : 0;\n        var prefix = htmlFieldPrefix + '-' + index.toString();\n\n        var contentTypesName = $(this).data(\"contenttypes-name\");\n        var contentItemsName = $(this).data(\"contentitems-name\");\n        $.ajax({\n            url: createEditorUrl + \"?id=\" + type + \"&prefix=\" + prefix + \"&prefixesName=\" + prefixesName + \"&contentTypesName=\" + contentTypesName + \"&contentItemsName=\" + contentItemsName + \"&targetId=\" + targetId + \"&flowmetadata=\" + flowmetadata + \"&parentContentType=\" + parentContentType + \"&partName=\" + partName\n        }).done(function (data) {\n            var result = JSON.parse(data);\n            $(document.getElementById(targetId)).append(result.Content);\n\n            var dom = $(result.Scripts);\n            dom.filter('script').each(function () {\n                $.globalEval(this.text || this.textContent || this.innerHTML || '');\n            });\n        });\n    });\n\n    $(document).on('click', '.insert-widget', function (event) {\n        var type = $(this).data(\"widget-type\");\n        var target = $(this).closest('.widget-template');\n        var targetId = $(this).data(\"target-id\");\n        var htmlFieldPrefix = $(this).data(\"html-field-prefix\");\n        var createEditorUrl = $('#' + targetId).data(\"buildeditorurl\");\n        var flowmetadata = $(this).data(\"flowmetadata\");\n        var prefixesName = $(this).data(\"prefixes-name\");\n        var parentContentType = $(this).data(\"parent-content-type\");\n        var partName = $(this).data(\"part-name\");\n\n        // Retrieve all index values knowing that some elements may have been moved / removed.\n        var indexes = $('#' + targetId).closest(\"form\").find(\"input[name*='Prefixes']\")\n            .filter(function (i, e) {\n                return $(e).val().substring(0, $(e).val().lastIndexOf('-')) === htmlFieldPrefix;\n            })\n            .map(function (i, e) {\n                return parseInt($(e).val().substring($(e).val().lastIndexOf('-') + 1)) || 0;\n            });\n\n        // Use a prefix based on the items count (not a guid) so that the browser autofill still works.\n        var index = indexes.length ? Math.max(...indexes) + 1 : 0;\n        var prefix = htmlFieldPrefix + '-' + index.toString();\n\n        var contentTypesName = $(this).data(\"contenttypes-name\");\n        var contentItemsName = $(this).data(\"contentitems-name\");\n        $.ajax({\n            url: createEditorUrl + \"?id=\" + type + \"&prefix=\" + prefix + \"&prefixesName=\" + prefixesName + \"&contentTypesName=\" + contentTypesName + \"&contentItemsName=\" + contentItemsName + \"&targetId=\" + targetId + \"&flowmetadata=\" + flowmetadata + \"&parentContentType=\" + parentContentType + \"&partName=\" + partName\n        }).done(function (data) {\n            var result = JSON.parse(data);\n            $(result.Content).insertBefore(target);\n\n            var dom = $(result.Scripts);\n            dom.filter('script').each(function () {\n                $.globalEval(this.text || this.textContent || this.innerHTML || '');\n            });\n        });\n    });\n\n    $(document).on('click', '.widget-delete', function () {\n        var $this = $(this);\n        confirmDialog({\n            ...$this.data(), callback: function (r) {\n                if (r) {\n                    $this.closest('.widget-template').remove();\n                    $(document).trigger('contentpreview:render');\n                }\n            }\n        });\n    });\n\n    $(document).on('change', '.widget-editor-footer label, .widget-editor-header label', function () {\n\n        var $tmpl = $(this).closest('.widget-template');\n        var $radio = $(this).find(\"input:first-child\");\n        if ($radio[0].id !== 'undefined' && $radio[0].id.indexOf('Size') > 0) {\n            var $radioSize = $(this).find(\"input:first-child\").val();\n            var classList = $tmpl.attr('class').split(' ');\n            $.each(classList, function (id, item) {\n                if (item.indexOf('col-md-') === 0) $tmpl.removeClass(item);\n            });\n            var colSize = Math.round($radioSize / 100 * 12);\n            $tmpl.addClass('col-md-' + colSize);\n\n            var dropdown = $(this).closest('.dropdown-menu');\n            dropdown.prev('button').text($radioSize + '%');\n        } else if ($radio[0].id !== 'undefined' && $radio[0].id.indexOf('Alignment') > 0) {\n            var svg = $(this).find('svg')[0].outerHTML;\n            var alignDropdown = $(this).closest('.dropdown-menu');\n            var $btn = alignDropdown.prev('button');\n            $btn.html(svg);\n        }\n\n        $(this).parent().find('.dropdown-item').removeClass('active');\n        $(this).toggleClass('active');\n        $(document).trigger('contentpreview:render');\n    });\n\n    $(document).on('click', '.widget-editor-btn-toggle', function () {\n        $(this).closest('.widget-editor').toggleClass('collapsed');\n    });\n\n    $(document).on('keyup', '.widget-editor-body .form-group input.content-caption-text', function () {\n        var headerTextLabel = $(this).closest('.widget-editor').find('.widget-editor-header:first .widget-editor-header-text');\n        var contentTypeDisplayText = headerTextLabel.data('content-type-display-text');\n        var title = $(this).val();\n        var newDisplayText = title + ' ' + contentTypeDisplayText;\n\n        headerTextLabel.text(newDisplayText);\n    });\n});\n"],"names":["widgetDragItem","lastContainer","widgetItemSourceId","widgetItemDestId","$","document","on","event","type","data","targetId","htmlFieldPrefix","createEditorUrl","prefixesName","flowmetadata","parentContentType","partName","indexes","closest","find","filter","i","e","val","substring","lastIndexOf","map","parseInt","prefix","index","length","Math","max","toString","contentTypesName","contentItemsName","ajax","url","done","result","JSON","parse","getElementById","append","Content","dom","Scripts","each","globalEval","text","textContent","innerHTML","target","insertBefore","$this","confirmDialog","callback","r","remove","trigger","$tmpl","$radio","id","indexOf","$radioSize","classList","attr","split","item","removeClass","colSize","round","addClass","dropdown","prev","svg","outerHTML","$btn","alignDropdown","html","parent","toggleClass","headerTextLabel","contentTypeDisplayText","title"],"mappings":"AACA,IAAIA,eAAgBC,cAAeC,mBAAoBC,iBAEvDC,EAAE,WACEA,EAAEC,UAAUC,EAAE,CAAC,QAAS,cAAe,SAAUC,CAAK,EAClD,IAAIC,EAAOJ,EAAE,IAAI,EAAEK,IAAI,CAAC,eACpBC,EAAWN,EAAE,IAAI,EAAEK,IAAI,CAAC,aACxBE,EAAkBP,EAAE,IAAI,EAAEK,IAAI,CAAC,qBAC/BG,EAAkBR,EAAE,IAAMM,GAAUD,IAAI,CAAC,kBACzCI,EAAeT,EAAE,IAAI,EAAEK,IAAI,CAAC,iBAC5BK,EAAeV,EAAE,IAAI,EAAEK,IAAI,CAAC,gBAC5BM,EAAoBX,EAAE,IAAI,EAAEK,IAAI,CAAC,uBACjCO,EAAWZ,EAAE,IAAI,EAAEK,IAAI,CAAC,aAGxBQ,EAAUb,EAAE,IAAMM,GAAUQ,OAAO,CAAC,QAAQC,IAAI,CAAC,2BAChDC,MAAM,CAAC,SAAUC,CAAC,CAAEC,CAAC,EAClB,OAAOlB,EAAEkB,GAAGC,GAAG,GAAGC,SAAS,CAAC,EAAGpB,EAAEkB,GAAGC,GAAG,GAAGE,WAAW,CAAC,QAAUd,CACpE,GACCe,GAAG,CAAC,SAAUL,CAAC,CAAEC,CAAC,EACf,OAAOK,SAASvB,EAAEkB,GAAGC,GAAG,GAAGC,SAAS,CAACpB,EAAEkB,GAAGC,GAAG,GAAGE,WAAW,CAAC,KAAO,KAAO,CAC9E,GAIAG,EAASjB,EAAkB,IAAMkB,AADzBZ,CAAAA,EAAQa,MAAM,CAAGC,KAAKC,GAAG,IAAIf,GAAW,EAAI,CAAA,EACbgB,QAAQ,GAE/CC,EAAmB9B,EAAE,IAAI,EAAEK,IAAI,CAAC,qBAChC0B,EAAmB/B,EAAE,IAAI,EAAEK,IAAI,CAAC,qBACpCL,EAAEgC,IAAI,CAAC,CACHC,IAAKzB,EAAkB,OAASJ,EAAO,WAAaoB,EAAS,iBAAmBf,EAAe,qBAAuBqB,EAAmB,qBAAuBC,EAAmB,aAAezB,EAAW,iBAAmBI,EAAe,sBAAwBC,EAAoB,aAAeC,CAC9S,GAAGsB,IAAI,CAAC,SAAU7B,CAAI,EAClB,IAAI8B,EAASC,KAAKC,KAAK,CAAChC,GACxBL,EAAEC,SAASqC,cAAc,CAAChC,IAAWiC,MAAM,CAACJ,EAAOK,OAAO,EAG1DC,AADUzC,EAAEmC,EAAOO,OAAO,EACtB1B,MAAM,CAAC,UAAU2B,IAAI,CAAC,WACtB3C,EAAE4C,UAAU,CAAC,IAAI,CAACC,IAAI,EAAI,IAAI,CAACC,WAAW,EAAI,IAAI,CAACC,SAAS,EAAI,GACpE,EACJ,EACJ,GAEA/C,EAAEC,UAAUC,EAAE,CAAC,QAAS,iBAAkB,SAAUC,CAAK,EACrD,IAAIC,EAAOJ,EAAE,IAAI,EAAEK,IAAI,CAAC,eACpB2C,EAAShD,EAAE,IAAI,EAAEc,OAAO,CAAC,oBACzBR,EAAWN,EAAE,IAAI,EAAEK,IAAI,CAAC,aACxBE,EAAkBP,EAAE,IAAI,EAAEK,IAAI,CAAC,qBAC/BG,EAAkBR,EAAE,IAAMM,GAAUD,IAAI,CAAC,kBACzCK,EAAeV,EAAE,IAAI,EAAEK,IAAI,CAAC,gBAC5BI,EAAeT,EAAE,IAAI,EAAEK,IAAI,CAAC,iBAC5BM,EAAoBX,EAAE,IAAI,EAAEK,IAAI,CAAC,uBACjCO,EAAWZ,EAAE,IAAI,EAAEK,IAAI,CAAC,aAGxBQ,EAAUb,EAAE,IAAMM,GAAUQ,OAAO,CAAC,QAAQC,IAAI,CAAC,2BAChDC,MAAM,CAAC,SAAUC,CAAC,CAAEC,CAAC,EAClB,OAAOlB,EAAEkB,GAAGC,GAAG,GAAGC,SAAS,CAAC,EAAGpB,EAAEkB,GAAGC,GAAG,GAAGE,WAAW,CAAC,QAAUd,CACpE,GACCe,GAAG,CAAC,SAAUL,CAAC,CAAEC,CAAC,EACf,OAAOK,SAASvB,EAAEkB,GAAGC,GAAG,GAAGC,SAAS,CAACpB,EAAEkB,GAAGC,GAAG,GAAGE,WAAW,CAAC,KAAO,KAAO,CAC9E,GAIAG,EAASjB,EAAkB,IAAMkB,AADzBZ,CAAAA,EAAQa,MAAM,CAAGC,KAAKC,GAAG,IAAIf,GAAW,EAAI,CAAA,EACbgB,QAAQ,GAE/CC,EAAmB9B,EAAE,IAAI,EAAEK,IAAI,CAAC,qBAChC0B,EAAmB/B,EAAE,IAAI,EAAEK,IAAI,CAAC,qBACpCL,EAAEgC,IAAI,CAAC,CACHC,IAAKzB,EAAkB,OAASJ,EAAO,WAAaoB,EAAS,iBAAmBf,EAAe,qBAAuBqB,EAAmB,qBAAuBC,EAAmB,aAAezB,EAAW,iBAAmBI,EAAe,sBAAwBC,EAAoB,aAAeC,CAC9S,GAAGsB,IAAI,CAAC,SAAU7B,CAAI,EAClB,IAAI8B,EAASC,KAAKC,KAAK,CAAChC,GACxBL,EAAEmC,EAAOK,OAAO,EAAES,YAAY,CAACD,GAG/BP,AADUzC,EAAEmC,EAAOO,OAAO,EACtB1B,MAAM,CAAC,UAAU2B,IAAI,CAAC,WACtB3C,EAAE4C,UAAU,CAAC,IAAI,CAACC,IAAI,EAAI,IAAI,CAACC,WAAW,EAAI,IAAI,CAACC,SAAS,EAAI,GACpE,EACJ,EACJ,GAEA/C,EAAEC,UAAUC,EAAE,CAAC,QAAS,iBAAkB,WACtC,IAAIgD,EAAQlD,EAAE,IAAI,EAClBmD,cAAc,CACV,GAAGD,EAAM7C,IAAI,EAAE,CAAE+C,SAAU,SAAUC,CAAC,EAC9BA,IACAH,EAAMpC,OAAO,CAAC,oBAAoBwC,MAAM,GACxCtD,EAAEC,UAAUsD,OAAO,CAAC,yBAE5B,CACJ,EACJ,GAEAvD,EAAEC,UAAUC,EAAE,CAAC,SAAU,2DAA4D,WAEjF,IAAIsD,EAAQxD,EAAE,IAAI,EAAEc,OAAO,CAAC,oBACxB2C,EAASzD,EAAE,IAAI,EAAEe,IAAI,CAAC,qBAC1B,GAAI0C,AAAiB,cAAjBA,CAAM,CAAC,EAAE,CAACC,EAAE,EAAoBD,CAAM,CAAC,EAAE,CAACC,EAAE,CAACC,OAAO,CAAC,QAAU,EAAG,CAClE,IAAIC,EAAa5D,EAAE,IAAI,EAAEe,IAAI,CAAC,qBAAqBI,GAAG,GAClD0C,EAAYL,EAAMM,IAAI,CAAC,SAASC,KAAK,CAAC,KAC1C/D,EAAE2C,IAAI,CAACkB,EAAW,SAAUH,CAAE,CAAEM,CAAI,EACA,IAA5BA,EAAKL,OAAO,CAAC,YAAkBH,EAAMS,WAAW,CAACD,EACzD,GACA,IAAIE,EAAUvC,KAAKwC,KAAK,CAACP,EAAa,IAAM,IAC5CJ,EAAMY,QAAQ,CAAC,UAAYF,GAG3BG,AADerE,EAAE,IAAI,EAAEc,OAAO,CAAC,kBACtBwD,IAAI,CAAC,UAAUzB,IAAI,CAACe,EAAa,IAC9C,MAAO,GAAIH,AAAiB,cAAjBA,CAAM,CAAC,EAAE,CAACC,EAAE,EAAoBD,CAAM,CAAC,EAAE,CAACC,EAAE,CAACC,OAAO,CAAC,aAAe,EAAG,CAC9E,IAAIY,EAAMvE,EAAE,IAAI,EAAEe,IAAI,CAAC,MAAM,CAAC,EAAE,CAACyD,SAAS,CAG1CC,AADWC,AADS1E,EAAE,IAAI,EAAEc,OAAO,CAAC,kBACXwD,IAAI,CAAC,UACzBK,IAAI,CAACJ,EACd,CAEAvE,EAAE,IAAI,EAAE4E,MAAM,GAAG7D,IAAI,CAAC,kBAAkBkD,WAAW,CAAC,UACpDjE,EAAE,IAAI,EAAE6E,WAAW,CAAC,UACpB7E,EAAEC,UAAUsD,OAAO,CAAC,wBACxB,GAEAvD,EAAEC,UAAUC,EAAE,CAAC,QAAS,4BAA6B,WACjDF,EAAE,IAAI,EAAEc,OAAO,CAAC,kBAAkB+D,WAAW,CAAC,YAClD,GAEA7E,EAAEC,UAAUC,EAAE,CAAC,QAAS,6DAA8D,WAClF,IAAI4E,EAAkB9E,EAAE,IAAI,EAAEc,OAAO,CAAC,kBAAkBC,IAAI,CAAC,0DACzDgE,EAAyBD,EAAgBzE,IAAI,CAAC,6BAC9C2E,EAAQhF,EAAE,IAAI,EAAEmB,GAAG,GAGvB2D,EAAgBjC,IAAI,CAFCmC,EAAQ,IAAMD,EAGvC,EACJ"}
