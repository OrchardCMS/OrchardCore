var widgetDragItem,lastContainer,widgetItemSourceId,widgetItemDestId;$(function(){$(document).on("click",".add-widget",function(t){var e=$(this).data("widget-type"),n=$(this).data("target-id"),i=$(this).data("html-field-prefix"),a=$("#"+n).data("buildeditorurl"),d=$(this).data("prefixes-name"),r=$(this).data("flowmetadata"),o=$(this).data("parent-content-type"),s=$(this).data("part-name"),l=$("#"+n).closest("form").find("input[name*='Prefixes']").filter(function(t,e){return $(e).val().substring(0,$(e).val().lastIndexOf("-"))===i}).map(function(t,e){return parseInt($(e).val().substring($(e).val().lastIndexOf("-")+1))||0}),c=i+"-"+(l.length?Math.max(...l)+1:0).toString(),f=$(this).data("contenttypes-name"),m=$(this).data("contentitems-name");$.ajax({url:a+"?id="+e+"&prefix="+c+"&prefixesName="+d+"&contentTypesName="+f+"&contentItemsName="+m+"&targetId="+n+"&flowmetadata="+r+"&parentContentType="+o+"&partName="+s}).done(function(t){var e=JSON.parse(t);$(document.getElementById(n)).append(e.Content),$(e.Scripts).filter("script").each(function(){$.globalEval(this.text||this.textContent||this.innerHTML||"")})})}),$(document).on("click",".insert-widget",function(t){var e=$(this).data("widget-type"),n=$(this).closest(".widget-template"),i=$(this).data("target-id"),a=$(this).data("html-field-prefix"),d=$("#"+i).data("buildeditorurl"),r=$(this).data("flowmetadata"),o=$(this).data("prefixes-name"),s=$(this).data("parent-content-type"),l=$(this).data("part-name"),c=$("#"+i).closest("form").find("input[name*='Prefixes']").filter(function(t,e){return $(e).val().substring(0,$(e).val().lastIndexOf("-"))===a}).map(function(t,e){return parseInt($(e).val().substring($(e).val().lastIndexOf("-")+1))||0}),f=a+"-"+(c.length?Math.max(...c)+1:0).toString(),m=$(this).data("contenttypes-name"),p=$(this).data("contentitems-name");$.ajax({url:d+"?id="+e+"&prefix="+f+"&prefixesName="+o+"&contentTypesName="+m+"&contentItemsName="+p+"&targetId="+i+"&flowmetadata="+r+"&parentContentType="+s+"&partName="+l}).done(function(t){var e=JSON.parse(t);$(e.Content).insertBefore(n),$(e.Scripts).filter("script").each(function(){$.globalEval(this.text||this.textContent||this.innerHTML||"")})})}),$(document).on("click",".widget-delete",function(){var t=$(this);confirmDialog({...t.data(),callback:function(e){e&&(t.closest(".widget-template").remove(),$(document).trigger("contentpreview:render"))}})}),$(document).on("change",".widget-editor-footer label, .widget-editor-header label",function(){var t=$(this).closest(".widget-template"),e=$(this).find("input:first-child");if("undefined"!==e[0].id&&e[0].id.indexOf("Size")>0){var n=$(this).find("input:first-child").val(),i=t.attr("class").split(" ");$.each(i,function(e,n){0===n.indexOf("col-md-")&&t.removeClass(n)});var a=Math.round(n/100*12);t.addClass("col-md-"+a),$(this).closest(".dropdown-menu").prev("button").text(n+"%")}else if("undefined"!==e[0].id&&e[0].id.indexOf("Alignment")>0){var d=$(this).find("svg")[0].outerHTML;$(this).closest(".dropdown-menu").prev("button").html(d)}$(this).parent().find(".dropdown-item").removeClass("active"),$(this).toggleClass("active"),$(document).trigger("contentpreview:render")}),$(document).on("click",".widget-editor-btn-toggle",function(){$(this).closest(".widget-editor").toggleClass("collapsed")}),$(document).on("keyup",".widget-editor-body .form-group input.content-caption-text",function(){var t=$(this).closest(".widget-editor").find(".widget-editor-header:first .widget-editor-header-text"),e=t.data("content-type-display-text"),n=$(this).val();t.text(n+" "+e)})});