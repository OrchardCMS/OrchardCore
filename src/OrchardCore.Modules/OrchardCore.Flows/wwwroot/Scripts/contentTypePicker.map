{"version":3,"sources":["<anon>"],"sourcesContent":["var contentTypePickerApp;\nvar contentTypePickerInitialized;\n\nfunction initializeContentTypePickerApplication(pathBase) {\n    if (contentTypePickerInitialized) {\n        return;\n    }\n\n    contentTypePickerInitialized = true;\n\n    contentTypePickerApp = new Vue({\n        el: \"#contentTypePickerApp\",\n        data: {\n            contentTypes: [],\n            categories: [],\n            searchFilter: \"\",\n            selectedCategory: \"All\",\n            pathBase: pathBase || \"\",\n            currentConfig: null,\n        },\n        computed: {\n            filteredContentTypes: function () {\n                var self = this;\n                return this.contentTypes.filter(function (contentType) {\n                    // Filter by category\n                    if (self.selectedCategory !== \"All\" && contentType.category !== self.selectedCategory) {\n                        return false;\n                    }\n                    // Filter by search term\n                    if (self.searchFilter) {\n                        var searchLower = self.searchFilter.toLowerCase();\n                        var nameMatch = contentType.displayName.toLowerCase().indexOf(searchLower) >= 0;\n                        var descMatch = contentType.description && contentType.description.toLowerCase().indexOf(searchLower) >= 0;\n                        return nameMatch || descMatch;\n                    }\n                    return true;\n                });\n            },\n        },\n        methods: {\n            configure: function (options) {\n                this.currentConfig = options;\n                this.contentTypes = options.contentTypes || [];\n\n                // Build unique categories list\n                var categorySet = {};\n                this.contentTypes.forEach(function (contentType) {\n                    if (contentType.category) {\n                        categorySet[contentType.category] = true;\n                    }\n                });\n                this.categories = [\"All\"].concat(Object.keys(categorySet).sort());\n\n                // Reset filters\n                this.searchFilter = \"\";\n                this.selectedCategory = \"All\";\n            },\n            selectCategory: function (category) {\n                this.selectedCategory = category;\n            },\n            selectContentType: function (contentType) {\n                if (this.currentConfig && this.currentConfig.onContentTypeSelected) {\n                    this.currentConfig.onContentTypeSelected(contentType, this.currentConfig);\n                }\n            },\n            getPreviewImageUrl: function (contentType) {\n                if (contentType.previewImage) {\n                    // Handle tilde paths\n                    if (contentType.previewImage.startsWith(\"~/\")) {\n                        return this.pathBase + contentType.previewImage.substring(1);\n                    }\n                    return contentType.previewImage;\n                }\n                return this.pathBase + \"/OrchardCore.Flows/Images/content-type-placeholder.png\";\n            },\n            handleImageError: function (event, contentType) {\n                // Replace the broken image with a placeholder div\n                var img = event.target;\n                var placeholder = document.createElement(\"div\");\n                placeholder.className = \"card-img-top img-placeholder\";\n                placeholder.innerHTML = '<i class=\"fa fa-cube\" aria-hidden=\"true\"></i>';\n                img.parentNode.replaceChild(placeholder, img);\n            },\n        },\n    });\n}\n\n// Integration function to trigger existing add-widget functionality\nfunction contentTypePickerSelectContentType(contentType, config) {\n    // Create a synthetic element with the required data attributes\n    var $trigger = $('<a class=\"add-widget\">')\n        .data(\"target-id\", config.targetId)\n        .data(\"html-field-prefix\", config.htmlFieldPrefix)\n        .data(\"prefixes-name\", config.prefixesName)\n        .data(\"contenttypes-name\", config.contentTypesName)\n        .data(\"contentitems-name\", config.contentItemsName)\n        .data(\"widget-type\", contentType.name)\n        .data(\"flowmetadata\", false)\n        .data(\"parent-content-type\", config.parentContentType)\n        .data(\"part-name\", config.partName);\n\n    // Trigger the existing add-widget handler from flows.edit.js\n    $trigger.trigger(\"click\");\n\n    // Close the modal\n    if (config.modalId) {\n        var modalElement = document.getElementById(config.modalId);\n        if (modalElement) {\n            var modal = bootstrap.Modal.getInstance(modalElement);\n            if (modal) {\n                modal.hide();\n            }\n        }\n    }\n}\n"],"names":["contentTypePickerApp","contentTypePickerInitialized","initializeContentTypePickerApplication","pathBase","Vue","el","data","contentTypes","categories","searchFilter","selectedCategory","currentConfig","computed","filteredContentTypes","self","filter","contentType","category","searchLower","toLowerCase","nameMatch","displayName","indexOf","descMatch","description","methods","configure","options","categorySet","forEach","concat","Object","keys","sort","selectCategory","selectContentType","onContentTypeSelected","getPreviewImageUrl","previewImage","startsWith","substring","handleImageError","event","img","target","placeholder","document","createElement","className","innerHTML","parentNode","replaceChild","contentTypePickerSelectContentType","config","$trigger","$","targetId","htmlFieldPrefix","prefixesName","contentTypesName","contentItemsName","name","parentContentType","partName","trigger","modalId","modalElement","getElementById","modal","bootstrap","Modal","getInstance","hide"],"mappings":"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"}
