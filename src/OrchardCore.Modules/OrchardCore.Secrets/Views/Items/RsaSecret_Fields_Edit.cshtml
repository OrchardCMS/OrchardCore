@model OrchardCore.Secrets.ViewModels.RsaSecretViewModel

<div class="mb-3">
    <label asp-for="IncludesPrivateKey" class="form-label">@T["Key Type"]</label>
    <select asp-for="IncludesPrivateKey" asp-items="Model.KeyTypes" class="form-select"></select>
    <span class="hint">@T["Select whether to store only the public key or both public and private keys."]</span>
</div>

@if (Model.IsNew)
{
    <div class="mb-3">
        <label asp-for="PublicKey" class="form-label">@T["Public Key (Base64)"]</label>
        <textarea asp-for="PublicKey" class="form-control text-monospace" rows="4"></textarea>
    </div>

    <div class="mb-3" id="private-key-group">
        <label asp-for="PrivateKey" class="form-label">@T["Private Key (Base64)"]</label>
        <textarea asp-for="PrivateKey" class="form-control text-monospace" rows="6"></textarea>
        <span class="hint">@T["The private key will be encrypted before storage."]</span>
    </div>
}
else
{
    <div class="mb-3">
        <label class="form-label">@T["Current Public Key (Base64)"]</label>
        <textarea class="form-control text-monospace" rows="4" readonly>@Model.PublicKey</textarea>
    </div>

    <div class="mb-3">
        <div class="form-check">
            <input asp-for="HasNewKeys" class="form-check-input" type="checkbox" />
            <label asp-for="HasNewKeys" class="form-check-label">@T["Generate new keys"]</label>
        </div>
    </div>

    <div id="new-keys-group" style="display: none;">
        <div class="mb-3">
            <label asp-for="NewPublicKey" class="form-label">@T["New Public Key (Base64)"]</label>
            <textarea asp-for="NewPublicKey" class="form-control text-monospace" rows="4"></textarea>
        </div>

        <div class="mb-3" id="new-private-key-group">
            <label asp-for="NewPrivateKey" class="form-label">@T["New Private Key (Base64)"]</label>
            <textarea asp-for="NewPrivateKey" class="form-control text-monospace" rows="6"></textarea>
        </div>
    </div>
}

<script at="Foot">
    document.addEventListener('DOMContentLoaded', function () {
        var hasNewKeysCheckbox = document.getElementById('@Html.IdFor(m => m.HasNewKeys)');
        var newKeysGroup = document.getElementById('new-keys-group');

        if (hasNewKeysCheckbox && newKeysGroup) {
            function toggleNewKeys() {
                newKeysGroup.style.display = hasNewKeysCheckbox.checked ? 'block' : 'none';
            }
            hasNewKeysCheckbox.addEventListener('change', toggleNewKeys);
            toggleNewKeys();
        }
    });
</script>
